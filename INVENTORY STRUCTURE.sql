CREATE DATABASE INVENTORY;
USE INVENTORY;
 
 --CREATE TABLES
 CREATE TABLE SUPPLIER
 (SID CHAR(5),
 SNAME VARCHAR(25),
 SADDR VARCHAR(25),
 SCITY VARCHAR(20),
 SPHONE CHAR(10),
 SEMAIL VARCHAR(25));
 SELECT * FROM SUPPLIER;
  
 CREATE TABLE PRODUCT
 (PID CHAR(5),
 PDESC VARCHAR(25),
 PRICE DECIMAL(10,2),
 CATEGORY CHAR(2),
 SID CHAR(5));
 SELECT * FROM PRODUCT;

 CREATE TABLE CUST
 (CID CHAR(5),
 CNAME VARCHAR(25),
 CADDR VARCHAR(25),
 CCITY VARCHAR(20),
 CPHONE CHAR(10),
 CEMAIL VARCHAR(25),
 CDOB DATE);
 SELECT * FROM CUST;

CREATE TABLE ORDERS
(OID CHAR(5),
ODATE DATE,
CID CHAR(5),
PID CHAR(5),
OQTY DECIMAL(10,2));
SELECT * FROM ORDERS;

CREATE TABLE STOCK
(PID CHAR(5),
SQTY DECIMAL(10,2),
ROL DECIMAL(10,2),
MOQ DECIMAL(10,2));
SELECT * FROM STOCK;

--CONSTRAINTS
--SUPPLIER
ALTER TABLE SUPPLIER
ALTER COLUMN SID CHAR(5) NOT NULL;
ALTER TABLE SUPPLIER
ALTER COLUMN SNAME VARCHAR(25) NOT NULL;
ALTER TABLE SUPPLIER
ALTER COLUMN SADDR VARCHAR(25) NOT NULL;
ALTER TABLE SUPPLIER
ADD CONSTRAINT S1 DEFAULT 'DELHI' FOR SCITY;
ALTER TABLE SUPPLIER
ADD CONSTRAINT S2 UNIQUE (SPHONE);

--PRODUCT
ALTER TABLE PRODUCT
ALTER COLUMN PID CHAR(5) NOT NULL;
ALTER TABLE PRODUCT
ALTER COLUMN PDESC VARCHAR(25) NOT NULL;
ALTER TABLE PRODUCT
ADD CONSTRAINT P1 CHECK(PRICE > 0);
ALTER TABLE PRODUCT
ADD CONSTRAINT P2 CHECK(CATEGORY IN('IT','HA','HC'));

--CUSTOMER
ALTER TABLE CUST
ALTER COLUMN CID CHAR(5) NOT NULL;
ALTER TABLE CUST
ALTER COLUMN CNAME VARCHAR(25) NOT NULL;
ALTER TABLE CUST
ALTER COLUMN CADDR VARCHAR(25) NOT NULL;
ALTER TABLE CUST
ALTER COLUMN CCITY VARCHAR(20) NOT NULL;
ALTER TABLE CUST
ALTER COLUMN CPHONE CHAR(10) NOT NULL;
ALTER TABLE CUST
ALTER COLUMN CEMAIL VARCHAR(25) NOT NULL;
ALTER TABLE CUST
ADD CONSTRAINT C1 CHECK(CDOB < '01-JAN-2000');

--ORDERS
ALTER TABLE ORDERS
ALTER COLUMN OID CHAR(5) NOT NULL;
ALTER TABLE ORDERS
ADD CONSTRAINT Q1 CHECK(OQTY >=1);

--STOCK
ALTER TABLE STOCK
ADD CONSTRAINT ST1 CHECK(SQTY >=0);
ALTER TABLE STOCK
ADD CONSTRAINT ST2 CHECK(ROL >=0);
ALTER TABLE STOCK
ADD CONSTRAINT ST3 CHECK(MOQ >=5);

--ADDING KEYS(PRIMARY,FOREIGN)

ALTER TABLE SUPPLIER
ADD CONSTRAINT S3 PRIMARY KEY(SID);

ALTER TABLE PRODUCT
ADD CONSTRAINT P3 PRIMARY KEY(PID);
ALTER TABLE PRODUCT
ADD CONSTRAINT P4FK FOREIGN KEY(SID) REFERENCES SUPPLIER(SID);

ALTER TABLE CUST
ADD CONSTRAINT C2 PRIMARY KEY(CID);

ALTER TABLE ORDERS
ADD CONSTRAINT O2 PRIMARY KEY(OID);
ALTER TABLE ORDERS
ADD CONSTRAINT O3FK FOREIGN KEY(CID) REFERENCES CUST(CID);
ALTER TABLE ORDERS
ADD CONSTRAINT O4FK FOREIGN KEY(PID) REFERENCES PRODUCT(PID);

ALTER TABLE STOCK
ADD CONSTRAINT ST4FK FOREIGN KEY(PID) REFERENCES PRODUCT(PID);


---INSERTING VALUES

--SUPPLIER DETAILS...
SELECT * FROM SUPPLIER;
INSERT INTO SUPPLIER(SID,SNAME,SADDR,SCITY,SPHONE,SEMAIL)
VALUES('S0001','HP WORLD','SECTOR 11 DWARK','DELHI','9854352133','HPWORLD@GMAIL.COM');
INSERT INTO SUPPLIER 
VALUES('S0002','MEDCARE','SC KANPUR,NP ROAD','DEHRADHUN','8534669284','MEDCARE@GMAIL.COM');
INSERT INTO SUPPLIER 
VALUES('S0003','RETAIL SHOPPERS','45/B1,JANAKPURI','DELHI','9994720214','RETAILSHOP@YAHOO.COM.IN');
INSERT INTO SUPPLIER 
VALUES('S0004','IT PICKUP','DLF,PHASE 5','GURGAON','7033134984','ITPICKUP@GMAIL.COM');
INSERT INTO SUPPLIER 
VALUES('S0005','HOME FINISHER','C2-260,SUPERTECH','NAGPUR','9900490348','HOMEFINISH@OUTLOOK.COM');

--PRODUCT DETAILS..
SELECT * FROM PRODUCT;
INSERT INTO PRODUCT
VALUES('P0001','HP LAPTOP AND CHARGER',7000,'IT','S0001');
INSERT INTO PRODUCT
VALUES('P0002','MIXER GRINDER',10000,'HA','S0002');
INSERT INTO PRODUCT
VALUES('P0003','MOBILE PHONE',4000,'IT','S0003');
INSERT INTO PRODUCT
VALUES('P0004','STEAMER',400,'HC','S0004');
INSERT INTO PRODUCT
VALUES('P0005','HANGING LIGHTS',5000,'HA','S0003');
INSERT INTO PRODUCT
VALUES('P0006','HARD DISK',15000,'IT','S0002');
INSERT INTO PRODUCT
VALUES('P0007','CHAIRS AND TABLES',10500,'HA','S0003');
INSERT INTO PRODUCT
VALUES('P0008','HARD DISK 500GB',7000,'IT','S0004');


--CUSTOMER DETAILS..
SELECT * FROM CUST;

INSERT INTO CUST(CID,CNAME,CADDR,CCITY,CPHONE,CEMAIL,CDOB)
VALUES('C0001','HITESH KUMAR','SECTOR 13 DWARK','DELHI','9088329901','HITESH@GMAIL.COM','10-JAN-1996');
INSERT INTO CUST
VALUES('C0002','YASH MISHRA','HNO-893','NOIDA','8098810773','YMISHRA@GMAIL.COM','21-NOV-1996');
INSERT INTO CUST
VALUES('C0003','TEENA KAUR','DLF,PHASE-5','GURGAON','9765320033','TEENAKAUR@GMAIL.COM','19-JUNE-1999');
INSERT INTO CUST
VALUES('C0004','SHIVANGI KATARIA','FLAT NO-260,RAJDUR ROAD','DEHRADHUN','8859232810','SKATARIA28@GMAIL.COM','28-AUG-1998');
INSERT INTO CUST
VALUES('C0005','UPKAR JHANGHU','789/B4,PUNJABI BAGH','DELHI','8098810773','UPKAR26@GMAIL.COM','15-JUNE-1998');
INSERT INTO CUST
VALUES('C0006','ASHUTOSH SINGH','260,SECTOR-5','GURGAON','9723781299','ASINGH6@GMAIL.COM','6-OCT-1997');


--ORDER DETAILS..
SELECT * FROM ORDERS;

INSERT INTO ORDERS 
VALUES('O0001','15-JULY-2018','C0005','P0005',1);
INSERT INTO ORDERS 
VALUES('O0002','02-AUG-2017','C0002','P0007',4);
INSERT INTO ORDERS 
VALUES('O0003','15-JUNE-2016','C0001','P0001',2);
INSERT INTO ORDERS 
VALUES('O0004','23-MAR-1999','C0004','P0002',5);
INSERT INTO ORDERS 
VALUES('O0005','06-JULY-2010','C0004','P0004',7);
INSERT INTO ORDERS 
VALUES('O0006','27-JAN-2012','C0006','P0008',3);
INSERT INTO ORDERS 
VALUES('O0007','19-OCT-2017','C0003','P0003',1);

--STOCK DETAILS..
SELECT * FROM STOCK;

INSERT INTO STOCK
VALUES('P0005',3,4,8);
INSERT INTO STOCK
VALUES('P0007',2,5,20);
INSERT INTO STOCK
VALUES('P0005',6,4,15);
INSERT INTO STOCK
VALUES('P0001',0,1,10);
INSERT INTO STOCK
VALUES('P0003',3,7,19);
INSERT INTO STOCK
VALUES('P0006',3,2,6);
INSERT INTO STOCK
VALUES('P0002',7,9,22);
INSERT INTO STOCK
VALUES('P0006',1,7,8);

----

SELECT PID,PDESC,CATEGORY,SNAME,SCITY FROM SUPPLIER
INNER JOIN PRODUCT
ON SUPPLIER.SID=PRODUCT.SID;


---BILL

SELECT OID,ODATE,CNAME,CADDR,CPHONE,PDESC,PRICE,OQTY,PRICE*OQTY AS 'AMT' FROM ORDERS
INNER JOIN CUST
ON ORDERS.CID=CUST.CID
INNER JOIN PRODUCT
ON ORDERS.PID=PRODUCT.PID
INNER JOIN SUPPLIER
ON SUPPLIER.SID=PRODUCT.SID
ORDER BY ODATE;

